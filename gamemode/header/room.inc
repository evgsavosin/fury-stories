/*!
	@brief Заголовок для системы с комнатами
	@author Found (evg.savosin)
	@date 16.12.2016, update 15.01.2018
*/

enum E_ROOM_COORD
{
	rc_id, // Номер интерьера
	rc_number, // Номер комнаты
	Float: rc_pos			[	3	]
}

enum E_ROOM_DATA
{
	r_wall,
	r_roof,
	r_floor
}

/// For house system
new const hroom_coord		[][	E_ROOM_COORD	] = 
{
	// 1 - Studio [1]
	{1, 0, {-2714.1694, -1508.7211, 2602.0522}},
	{1, 1, {-2711.6748, -1516.2886, 2602.0522}},
	
	// 2 - Studio [2]
	{2, 0, {-2418.6580, -1175.8385, 2609.1135}},
	{2, 1, {-2413.3276, -1179.7222, 2609.1135}},
	
	// 3 - Studio [3]
	{3, 0, {-2464.2817, -752.8141, 2611.3220}},
	{3, 1, {-2467.9858, -748.6738, 2611.3220}},
	
	
	// 4 - 1 Room [1]
	{4, 0, {-2607.0491, 645.2376, 2567.0059}},
	{4, 1, {-2604.7544, 640.0934, 2567.0059}},
	
	// 5 - 1 Room [2]
	{5, 0, {-2617.7083, 1149.2936, 2566.9460}},
	{5, 1, {-2616.5769, 1154.8424, 2566.9460}},
	{5, 2, {-2623.7412, 1148.4913, 2566.9460}},
	
	// 6 - 1 Room [3]
	{6, 0, {-2245.3599, -1036.3398, 2613.7600}},
	{6, 1, {-2244.9717, -1040.0260, 2613.7600}},
	{6, 2, {-2237.7471, -1038.6183, 2613.7600}},
	
	// 7 - 2 Room [1]
	{7, 0, {-2587.0073, 41.9689, 2567.0059}},
	{7, 1, {-2581.3462, 47.6830, 2567.0059}},
	{7, 2, {-2588.9365, 46.6643, 2567.0059}},
	{7, 3, {-2592.2957, 41.8984, 2567.0059}},
	{7, 4, {-2585.4014, 38.5525, 2567.0088}},
	
	// 8 - 2 Room [2]
	{8, 0, {-2216.0356, -652.2796, 2611.3540}},
	{8, 1, {-2218.9993, -647.7225, 2611.3569}},
	{8, 2, {-2214.5413, -657.8613, 2611.3550}},
	{8, 3, {-2221.0728, -659.3890, 2611.3550}},
	
	// 9 - 3 Room [1]
	{9, 0, {-1775.1025, -650.8834, 2585.8474}},
	{9, 1, {-1769.8064, -650.7471, 2585.8484}},
	{9, 2, {-1778.0479, -654.1352, 2585.8464}},
	{9, 3, {-1780.9941, -647.9188, 2585.8464}},
	{9, 4, {-1777.7080, -640.8287, 2585.8484}},
	{9, 5, {-1785.3641, -640.0873, 2585.8474}},
	
	// 10 - 4 Room 2 Stage [1]
	{10, 0, {-1069.1300, 1655.4700, 2566.9958}},
	{10, 1, {-1067.2678, 1645.6616, 2566.9958}},
	{10, 2, {-1068.2667, 1665.0476, 2566.9958}},
	{10, 3, {-1075.9829, 1664.4718, 2566.9958}},
	{10, 4, {-1069.1095, 1653.2897, 2570.5159}},
	{10, 5, {-1065.9575, 1658.5830, 2570.5359}},
	{10, 6, {-1067.1156, 1647.0688, 2570.5159}},
	
	// 11 - 5 Room 2 Stage [1]
	{11, 0, {-2576.5422, -1350.4554, 2566.9858}},
	{11, 1, {-2575.3223, -1359.0330, 2566.9858}},
	{11, 2, {-2583.0593, -1351.5026, 2566.9858}},
	{11, 3, {-2576.1987, -1338.8290, 2566.9858}},
	{11, 4, {-2582.8835, -1339.5509, 2566.9858}},
	{11, 5, {-2584.1511, -1351.2305, 2570.6860}},
	{11, 6, {-2588.8057, -1351.9092, 2570.7061}},
	{11, 7, {-2582.7839, -1343.3684, 2570.6860}},
	{11, 8, {-2575.4688, -1352.5286, 2570.6860}},
	
	// 12 - Mansion [1]
	{12, 0, {-2573.8059, -1845.9927, 2566.9858}},
	{12, 1, {-2573.9229, -1855.0225, 2566.9858}},
	{12, 2, {-2579.0115, -1852.9866, 2566.9858}},
	{12, 3, {-2573.8706, -1836.1105, 2566.9878}},
	{12, 4, {-2583.3499, -1835.5442, 2566.9878}},
	{12, 5, {-2584.9421, -1843.8407, 2566.9858}},
	{12, 6, {-2587.0647, -1847.5372, 2570.6592}},
	{12, 7, {-2585.8247, -1854.0858, 2570.6602}},
	{12, 8, {-2593.9417, -1847.0475, 2570.6650}},
	{12, 9, {-2585.5242, -1839.6631, 2570.6646}}
};

/// For premise system
new const proom_coord 		[	][	E_ROOM_COORD	] =
{
	// 1 - Shop [1]
	{1, 0, {1712.0953, 1148.8762, 2468.5034}},
	{1, 1, {1718.8982, 1149.3267, 2468.5034}},
	
	// 2 - Shop [2]
	{2, 0, {2022.3409, 1225.1508, 2462.0605}},
	{2, 1, {2032.3143, 1225.4801, 2462.0605}},
	{2, 2, {2027.9385, 1222.2673, 2462.0547}},
	
	
	// 3 - Minimarket [1]
	{3, 0, {-3073.1768, -1195.0474, 2410.1545}},
	{3, 1, {-3073.1768, -1195.0474, 2410.1545}},
	
	// 4 - Minimarket [2]
	{4, 0, {-2997.0999, -1193.0284, 2404.6943}},
	{4, 1, {-2993.7258, -1187.1086, 2404.6953}},
	
	// 5 - Minimarket [3]
	{5, 0, {-2909.3459, -810.7640, 2383.4873}},
	{5, 1, {-2901.7671, -815.6022, 2382.5676}},
	
	
	// 6 - Pub [1]
	{6, 0, {2887.6790, 808.5596, 2516.3259}},
	{6, 1, {2886.7322, 817.9539, 2516.3359}},
	{6, 2, {2895.3269, 822.0677, 2516.3359}},
	{6, 3, {2892.4670, 814.6197, 2516.3269}},
	
	// 7 - Pub [2]
	{7, 0, {2887.4153, 1307.3430, 2516.3237}},
	{7, 1, {2892.5173, 1314.6376, 2516.3237}},
	
	// 8 - Pub [3]
	{8, 0, {2478.9031, 1918.9236, 2516.3159}},
	{8, 1, {2487.2534, 1923.5767, 2516.3171}},
	{8, 2, {2487.3010, 1916.1527, 2516.3179}},
	
	// 9 - Socle [0]
	{9, 0, {2226.2832, 2529.8301, 2930.7280}},
	{9, 1, {2220.9163, 2525.4680, 2930.7241}},
	{9, 2, {2212.0706, 2527.9531, 2930.7280}},
	{9, 3, {2211.1702, 2532.9675, 2930.7319}},
	
	// 10 - Club [0]
	{10, 0, {-2781.8340, -515.5315, 1883.4873}},
	{10, 1, {-2772.6372, -522.0051, 1883.4873}},
	{10, 2, {-2763.5122, -522.8126, 1884.1538}},
	{10, 3, {-2781.8638, -523.1803, 1883.4873}},
	{10, 4, {-2780.1353, -528.9073, 1883.4883}},
	{10, 5, {-2772.0767, -532.9908, 1883.4873}}
	
};

new hroom_data				[	MAX_HOUSES 	][	MAX_ROOMS	][ E_ROOM_DATA 	],
	proom_data				[	MAX_PREMISES][	MAX_ROOMS	][ E_ROOM_DATA 	];


Clear:hroom_data(index)
{
	for (new i; i < MAX_ROOMS; i++)
	{
		hroom_data[index][i][r_wall] = 
		hroom_data[index][i][r_roof] = 
		hroom_data[index][i][r_floor] = 0;
	}
}

Clear:proom_data(index)
{
	for (new i; i < MAX_ROOMS; i++)
	{
		proom_data[index][i][r_wall] = 
		proom_data[index][i][r_roof] = 
		proom_data[index][i][r_floor] = 0;
	}
}

Clear:room_data(index, type)
{
	if (type == TYPE_REN_HOUSE)
	{
		Clear:hroom_data(index);
	}
	else 
	{
		Clear:proom_data(index);
	}
}

Update:reset_room_data(const id, type)
{	
	format:g_string("\
		UPDATE " #__ROOMS " \
		SET r_roof = 0, \
			r_wall = 0, \
			r_floor = 0 \
		WHERE \
			r_owner_id = %i AND \
			r_owner_type = %i",
		id, 
		type
	);
	
	mysql_pquery(db, g_string);
}		
	
Update:room_data(index, room_index, type = TYPE_REN_HOUSE)
{
	format:g_string("UPDATE " #__ROOMS " \
		SET \
			r_roof = %i, \
			r_floor = %i, \
			r_wall = %i \
		WHERE \
			r_owner_id = %i AND \
			r_owner_type = %i AND \
			r_number = %i",
		type == TYPE_REN_HOUSE ? hroom_data[index][room_index][r_roof] : proom_data[index][room_index][r_roof],
		type == TYPE_REN_HOUSE ? hroom_data[index][room_index][r_floor] : proom_data[index][room_index][r_floor],
		type == TYPE_REN_HOUSE ? hroom_data[index][room_index][r_wall] : proom_data[index][room_index][r_wall],
		type == TYPE_REN_HOUSE ? GetHouseId(index) : GetPremiseId(index),
		type,
		room_index
	);
	
	mysql_tquery(db, g_string);
	
	return 1;
}